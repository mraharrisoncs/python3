(this["webpackJsonpweb-app"]=this["webpackJsonpweb-app"]||[]).push([[31,68,90,96,110],{1285:function(e,t,a){"use strict";a.r(t);var s=a(198),i=a(4),l=a.n(i);t.default=e=>{let t=e.size,a=void 0===t?24:t,i=e.color,n=void 0===i?"#b2b2b2":i,c=e.viewBox,r=void 0===c?"0 0 24 24":c,o=Object(s.a)(e,["size","color","viewBox"]);return l.a.createElement("svg",Object.assign({width:a,height:a,viewBox:r},o),l.a.createElement("path",{fill:n,fillRule:"evenodd",stroke:"none",strokeWidth:"1",id:"Icon/small/clip",d:"M5 8.654a1 1 0 112 0V14a5 5 0 0010 0V7.993a2.993 2.993 0 00-5.985 0v5.978a.998.998 0 001.995 0V8.654a1 1 0 012 0v5.317a2.998 2.998 0 11-5.995 0V7.993a4.993 4.993 0 119.985 0V14a7 7 0 01-14 0V8.654z"}))}},1290:function(e,t,a){"use strict";a.r(t);var s=a(198),i=a(4),l=a.n(i);t.default=e=>{let t=e.size,a=void 0===t?24:t,i=e.color,n=void 0===i?"#b2b2b2":i,c=e.viewBox,r=void 0===c?"0 0 24 24":c,o=Object(s.a)(e,["size","color","viewBox"]);return l.a.createElement("svg",Object.assign({width:a,height:a,viewBox:r},o),l.a.createElement("path",{fill:n,fillRule:"evenodd",stroke:"none",strokeWidth:"1",id:"Icon/small/image",d:"M9.345 14.237a.8.8 0 00-1.01.152l-1.142 1.278A.8.8 0 007.789 17h8.582a.8.8 0 00.634-1.289l-2.701-3.497a.8.8 0 00-1.233-.04l-1.655 1.87.618.619a.8.8 0 01-1.131 1.131l-1.558-1.557zM6.4 4h11.2A2.4 2.4 0 0120 6.4v11.2a2.4 2.4 0 01-2.4 2.4H6.4A2.4 2.4 0 014 17.6V6.4A2.4 2.4 0 016.4 4zM9 11a2 2 0 100-4 2 2 0 000 4z"}))}},1293:function(e,t,a){"use strict";a.r(t);var s=a(198),i=a(4),l=a.n(i);t.default=e=>{let t=e.size,a=void 0===t?24:t,i=e.color,n=void 0===i?"#b2b2b2":i,c=e.viewBox,r=void 0===c?"0 0 24 24":c,o=Object(s.a)(e,["size","color","viewBox"]);return l.a.createElement("svg",Object.assign({width:a,height:a,viewBox:r},o),l.a.createElement("path",{fill:n,fillRule:"evenodd",stroke:"none",strokeWidth:"1",id:"Icon/small/file",d:"M6 4h7.572a2 2 0 011.414.586l4.428 4.428A2 2 0 0120 10.428V18a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2zm8.707 2.707A1 1 0 0013 7.414V10a1 1 0 001 1h2.586a1 1 0 00.707-1.707l-2.586-2.586z"}))}},1312:function(e,t,a){"use strict";a.r(t);var s=a(198),i=a(4),l=a.n(i);t.default=e=>{let t=e.size,a=void 0===t?24:t,i=e.color,n=void 0===i?"#b2b2b2":i,c=e.viewBox,r=void 0===c?"0 0 24 24":c,o=Object(s.a)(e,["size","color","viewBox"]);return l.a.createElement("svg",Object.assign({width:a,height:a,viewBox:r},o),l.a.createElement("path",{fill:n,fillRule:"evenodd",stroke:"none",strokeWidth:"1",id:"Icon/small/formatting",d:"M10.093 15H5.907l-.465 1.307a1 1 0 01-1.884-.67l3-8.444a1 1 0 01.942-.665h1a1 1 0 01.942.665l3 8.444a1 1 0 11-1.884.67L10.093 15zm-.71-2L8 9.108 6.617 13h2.766zm9.548 3.41C16.84 17.72 13 17.12 13 14.5c0-1.572 1.384-2.428 3.208-2.62a6.57 6.57 0 011.788.043c-.11-1.078-2.527-1.323-3.164-.368a1 1 0 11-1.664-1.11C14.792 8.01 20 8.587 20 12v2.5c0 .243.322.5.5.5a1 1 0 010 2c-.545 0-1.113-.217-1.57-.59zm-.928-1.781A2.424 2.424 0 0118 14.5v-.514c-.06-.02-.131-.04-.21-.057a4.48 4.48 0 00-1.373-.06c-.932.099-1.417.399-1.417.631 0 .65 2.2.821 3.003.129z"}))}},1696:function(e,t,a){"use strict";var s=a(4),i=a.n(s);t.a=e=>t=>{class a extends s.Component{constructor(t){super(t);const a=!(this.props.fileProgress>=100);this.state={isVisible:a,maxValue:e&&e.maxValue||100}}componentDidMount(){this.timerID=setInterval(()=>this.checkProgress(),1e3)}componentWillUnmount(){clearInterval(this.timerID)}checkProgress(){this.props.fileProgress>=this.state.maxValue&&(this.setState({isVisible:!1}),clearInterval(this.timerID))}render(){return i.a.createElement(t,Object.assign({},this.state,this.props))}}return a}},1798:function(e,t,a){"use strict";var s=a(4),i=a.n(s),l=a(5),n=a.n(l),c=a(133),r=a(134),o=a(1468),d=a(45),h=a(201),m=a(36),p=a(46),u=a(37),g=a(226);t.a=e=>t=>{class a extends s.Component{constructor(e){super(e),this.addSelectedToAttachedLinks=this.addSelectedToAttachedLinks.bind(this),this.attachUniqueUrlsFoundInText=this.attachUniqueUrlsFoundInText.bind(this),this.checkForLinks=this.checkForLinks.bind(this),this.getUriInfo=this.getUriInfo.bind(this),this.setSelectedLink=this.setSelectedLink.bind(this),this.setSelectedEmbedSrc=this.setSelectedEmbedSrc.bind(this),this.setAttached=this.setAttached.bind(this),this.setAttachedEmbeds=this.setAttachedEmbeds.bind(this),this.addSelectedLinkToAttachedLinks=this.addSelectedLinkToAttachedLinks.bind(this),this.addSelectedLinkToAttachedEmbeds=this.addSelectedLinkToAttachedEmbeds.bind(this),this.addLibraryLink=this.addLibraryLink.bind(this),this.addLibraryLinks=this.addLibraryLinks.bind(this),this.resetLinksState=this.resetLinksState.bind(this),this.removeLink=this.removeLink.bind(this),this.removeOrphanedLinkAttachments=this.removeOrphanedLinkAttachments.bind(this),this.dismissAttachmentById=this.dismissAttachmentById.bind(this),this.setEmbedSrcFromText=this.setEmbedSrcFromText.bind(this),this.selectLinkInfo=this.selectLinkInfo.bind(this),this.updateSelectedLinkTitle=this.updateSelectedLinkTitle.bind(this),this.setAttachedLinks=this.setAttachedLinks.bind(this),this.handleAttachLinkPaste=this.handleAttachLinkPaste.bind(this),this.debouncedCheckForLinks=Object(l.debounce)(this.checkForLinks,1e3),this.state={attachedEmbeds:[],attachedLinks:[],selectedLink:null,selectedEmbedSrc:null,removedLinks:[],disableLinkTitleChange:!0,urlFromInput:null,currentlyFetchingLinkInfo:null,linkInfoFetchTimedOut:null}}componentWillUnmount(){this.debouncedCheckForLinks.cancel()}setSelectedLink(e){this.setState({selectedLink:e})}setSelectedEmbedSrc(e){this.setState({selectedEmbedSrc:e})}getEmbedLinkInfo(e){o.b({uri:e}).then(e=>(e&&e.data&&e.data.title&&this.setState({selectedLink:e.data}),e)).catch(e=>{m.a.notifyBugsnag(e,"WithLinkAttachmentFactory.getEmbedLinkInfo")})}getUriInfo(e,t){if(e){const a=!!this.state.selectedEmbedSrc;this.setState({currentlyFetchingLinkInfo:!0,linkInfoFetchTimedOut:!1}),o.b({uri:e}).then(e=>{e.data&&e.data.title&&!a?t(e):!e.data||e.data.title||a?e.data&&a&&this.getEmbedLinkInfo(this.state.selectedEmbedSrc):this.pollWebpagesApi(e.data.id,t,2,2e3)}).catch(e=>{Object(d.a)("error:",e),m.a.notifyBugsnag(e,"WithLinkAttachmentFactory.getUriInfo")})}}setAttached(e,t){switch(e){case"attachedLinks":this.setAttachedLinks(t);break;case"attachedEmbeds":this.setAttachedEmbeds(t)}}selectLinkInfo(e){this.getUriInfo(e,e=>{this.setSelectedLink(e&&e.data)}),this.setState({disableLinkTitleChange:!1,urlFromInput:e})}addSelectedLinkToAttachedLinks(e){const t=this.state.selectedLink,a=t.image,s=t.title,i=t.uri,l=t.id,c=e.context,r=n.a.cloneDeep(this.state.attachedLinks),o=h.h(i);this.attachedLinkExists(i)||o?o&&(this.props.globalAlertActions.showErrorGlobalAlert("stream,embed_type_not_allowed","This embed type is not allowed, please attach URL link."),Object(d.a)("Embed code is not allowed: ".concat(i))):(r.push({thumbUrl:a,title:s,url:i,uid:l,context:c}),this.setState({attachedLinks:r}))}addSelectedLinkToAttachedEmbeds(){const e=this.state.selectedLink,t=e.title,a=e.uri,s=e.id;if(h.j(a)&&h.m(a)){const e=n.a.cloneDeep(this.state.attachedEmbeds);e.push({title:t,content:a,uid:s}),this.setAttachedEmbeds(e)}else Object(d.a)("Embed src not whitelisted: ".concat(a))}addSelectedToAttachedLinks(){this.state.selectedEmbedSrc?this.addSelectedLinkToAttachedEmbeds():this.addSelectedLinkToAttachedLinks({context:u.a.BUTTON_CONTEXT}),this.setSelectedLink(null),this.setSelectedEmbedSrc(null)}setAttachedEmbeds(e){this.setState({attachedEmbeds:e})}setAttachedLinks(e){this.setState({attachedLinks:e})}pollWebpagesApi(e,t,a=2,s=2e3,i=0){o.a(e).then(l=>{i<a&&l.data&&!l.data.title?setTimeout(()=>{this.pollWebpagesApi(e,t,a,s,i+1)},s):l.data&&l.data.title?t(l):t(null)}).catch(e=>{m.a.notifyBugsnag(e,"WithLinkAttachmentFactory.pollWebpagesApi")})}addLibraryLink(e){this.attachedLinkExists(e.link_url)||this.setState(t=>{const a=n.a.cloneDeep(t.attachedLinks);return a.push(e),{attachedLinks:a}})}addLibraryLinks(e){Array.isArray(e)&&e.forEach(e=>this.addLibraryLink(e))}handleAttachLinkPaste(e){const t=e.clipboardData.getData("Text");this.attachUniqueUrlsFoundInText(t)}attachUniqueUrlsFoundInText(t,a){if(e&&e.max&&e.max<=this.state.attachedLinks.length)return;const s=h.g(t);if(Array.isArray(s)&&s.length)for(let e=0;e<s.length;e++){const i=s[e];if(!this.attachedLinkExists(i)&&!this.getLinkHasBeenRemoved(i)&&!this.isImageUrl(i)){this.getUriInfo(i,e=>{e||this.setState({linkInfoFetchTimedOut:!0,currentlyFetchingLinkInfo:!1}),this.setState({selectedLink:e.data,currentlyFetchingLinkInfo:!1},()=>{if(this.addSelectedLinkToAttachedLinks({context:u.a.MSG_BODY_CONTEXT}),a&&"function"===typeof a){const s=h.a(["(https?://)?",i],"gmi"),l=t.replace(s,(t,a)=>a?t:e.data.uri);a(l)}})});break}}}checkForLinks(e,t,a){if(a)return;const s=e.slice(-1);-1!==[" ",","].indexOf(s)&&this.attachUniqueUrlsFoundInText(e,t),this.removeOrphanedLinkAttachments(e)}removeLink(e){const t=n.a.cloneDeep(this.state.attachedLinks),a=t.map(e=>e.uid).indexOf(e),s=t.splice(a,1);return this.setAttachedLinks(t),s}removeOrphanedLinkAttachments(e){const t=h.g(e),a=n.a.cloneDeep(this.state.attachedLinks);let s;s=""!==t&&t?a.filter(e=>0===t.filter(t=>t===e.url).length):a,s&&s.forEach(e=>{e.context&&e.context===u.a.MSG_BODY_CONTEXT&&this.removeLink(e.uid)})}dismissAttachmentById(e){const t=this.removeLink(e),a=n.a.cloneDeep(this.state.removedLinks).concat(t);return this.setState({removedLinks:a}),t}resetLinksState(){this.setState({attachedLinks:[],attachedEmbeds:[],selectedLink:null,selectedEmbedSrc:null,removedLinks:[],currentlyFetchingLinkInfo:null,linkInfoFetchTimedOut:null})}setEmbedSrcFromText(e){const t=h.f(e);t?this.setState({selectedEmbedSrc:t}):this.setState({disableLinkTitleChange:!1})}attachedLinkExists(e){return!!this.state.attachedLinks.filter(t=>t.url===e).length}getLinkHasBeenRemoved(e){return!!this.state.removedLinks.filter(t=>t.url===e).length}updateSelectedLinkTitle(e){let t;this.state.selectedLink?(t=n.a.cloneDeep(this.state.selectedLink),t.title=e,this.setSelectedLink(t)):null===this.state.selectedLink&&(t={title:e,uri:this.state.urlFromInput,thumbUrl:null},this.setSelectedLink(t))}isImageUrl(e){return g.a.IMG_EXTENSIONS.includes(e.split(".").pop())}render(){return i.a.createElement(t,Object.assign({},this.props,this.state,{addSelectedToAttachedLinks:this.addSelectedToAttachedLinks,attachUniqueUrlsFoundInText:this.attachUniqueUrlsFoundInText,checkForLinks:this.debouncedCheckForLinks,resetLinksState:this.resetLinksState,setSelectedLink:this.setSelectedLink,addLibraryLink:this.addLibraryLink,addLibraryLinks:this.addLibraryLinks,setAttached:this.setAttached,dismissAttachmentById:this.dismissAttachmentById,removeOrphanedLinkAttachments:this.removeOrphanedLinkAttachments,setEmbedSrcFromText:this.setEmbedSrcFromText,selectLinkInfo:this.selectLinkInfo,updateSelectedLinkTitle:this.updateSelectedLinkTitle,disableLinkTitleChange:this.state.disableLinkTitleChange,setAttachedLinks:this.setAttachedLinks,handleAttachLinkPaste:this.handleAttachLinkPaste}))}}return Object(c.connect)(null,(function(e){return{globalAlertActions:Object(r.bindActionCreators)(p,e)}}))(a)}},1809:function(e,t,a){"use strict";var s=a(4),i=a.n(s),l=a(364),n=a(1293),c=a(1290),r=a(1285),o=a(156);a(1706);t.a=({handleSelectFiles:e,fileInputFieldValue:t,hasAttached:a,iconType:s,toolTipStr:d,iconStyle:h})=>{const m=["postbox-file"];a&&m.push("has-active-attachments");const p=d||i.a.createElement(o.default,{string:"attach-files-and-images",fallbackString:"Attach Files and Images"}),u="postbox-".concat(s||"file","-attach-icon"),g="postbox-".concat(s||"file","-attach-input");return i.a.createElement("li",{className:"qa-test-postbox-file-attach-icon",id:u},i.a.createElement(l.D,{type:"file",id:g,color:"link",className:"qa-test-postbox-attach-file file-attachment-upload-icon",multiple:"multiple","data-original-title":"Attach Files",value:t,onChange:e}),i.a.createElement("label",{htmlFor:g,className:m.join(" ")},(e=>{switch(e){case"image":return i.a.createElement(c.default,{className:"file-attachment-icon",style:h});case"clip":return i.a.createElement(r.default,{className:"file-attachment-icon",style:h});default:return i.a.createElement(n.default,{className:"file-attachment-icon",style:h})}})(s)),i.a.createElement(l.lb,{className:"tooltip",placement:"bottom",target:u,delay:0},p))}},1813:function(e,t,a){"use strict";var s=a(4),i=a.n(s),l=a(133),n=a(364),c=a(1662),r=a(156),o=a(14),d=a(73);t.a=Object(l.connect)((function(e){return{currentUser:d.c(e)}}))(({toggle:e,isModalOpen:t,attachLibraryItem:a,attachString:s,attachFallbackString:l,currentUser:d})=>{const h=o.a.isStudent(d);return i.a.createElement("div",null,i.a.createElement(n.M,{isOpen:t,toggle:e,className:"modal-lg composer-library-modal school-composer-library-modal"},i.a.createElement(n.P,{toggle:e},h?i.a.createElement(r.default,{string:"add-from-backpack",fallbackString:"Add from Backpack"}):i.a.createElement(r.default,{string:"postbox-add-from-library",fallbackString:"Add from Library"})),i.a.createElement(n.N,null,i.a.createElement(c.a,{hasMenu:!1,name:"ComposerLibraryModal",inModal:!0,isAttachmentPicker:!0,isModalOpen:t})),i.a.createElement(n.O,null,i.a.createElement(n.c,{color:"primary",onClick:a,className:"qa-test-attach-confirm attach-confirm"},i.a.createElement(r.default,{string:s||"attach-to-post",fallbackString:l||"Attach to Post"})))))})},1814:function(e,t,a){"use strict";var s=a(4),i=a.n(s),l=a(364),n=a(156),c=a(1204),r=a(1207),o=a(1543);t.a=({toggleScheduleModal:e,scheduleLabel:t})=>{const a=t?i.a.createElement("label",{htmlFor:"pollScheduler",className:"poll-send-later secondary-body"},t):"";return i.a.createElement("li",null,i.a.createElement("span",{className:"ttip qa-test-postbox-schedule-later-icon","data-action":"select-datetime",id:"postbox-schedule-later-icon"},i.a.createElement(r.a,{key:"schedule-post",onClick:e},i.a.createElement(c.a,{name:"time-icon"})),a),i.a.createElement(l.lb,{trigger:"click hover",className:"tooltip schedule-icon-tooltip",placement:"bottom",target:"postbox-schedule-later-icon",delay:0},i.a.createElement(n.default,{string:o.a.SCHEDULE_POST,fallbackString:"Schedule Your Post"})))}},1932:function(e,t,a){"use strict";var s=a(4),i=a.n(s),l=a(133),n=a(1813),c=a(1619),r=a(1707),o=a(1323),d=a(1809);class h extends s.Component{constructor(e){super(e),this.state={}}render(){const e=this.props,t=e.handleSelectFiles,a=e.fileInputFieldValue,s=e.fileUploadInstance,l=e.hasAttached,n=e.iconType,c=e.toolTipStr,r=e.iconStyle;return i.a.createElement(d.a,{handleSelectFiles:t,fileInputFieldValue:a,fileUploadInstance:s,hasAttached:l,iconType:n,toolTipStr:c,iconStyle:r})}}var m=Object(o.a)({})(h),p=a(364),u=a(156),g=a(1543),b=a(1312);var f=({setTrayState:e,isMarkdownHelpTrayOpen:t})=>i.a.createElement("li",{className:"qa-test-postbox-rich-text-icon",id:"postbox-rich-text-icon"},i.a.createElement(p.c,{color:"link",className:"rich-text-icon p-0",title:g.a.FORMAT_TEXT,onClick:function(){e&&e(!t)}},i.a.createElement(b.default,{className:"markdown-help-icon"})),i.a.createElement(p.lb,{className:"tooltip",placement:"bottom",target:"postbox-rich-text-icon",delay:0},i.a.createElement(u.default,{string:g.a.FORMAT_TEXT}))),k=a(1703),S=a(1814),L=a(509),C=a(1329),A=a(35),I=a.n(A),E=a(14),D=a(73),y=(a(1984),a(19));t.a=Object(l.connect)((function(e,t){return{currentUser:D.c(e)}}))(Object(L.a)(({attachedFilesBeginCb:e,attachedFilesChangeCb:t,setTrayState:a,isLibraryModalOpen:s,attachLibraryItem:l,handleLibraryBtnClick:o,attachmentDisplayOptions:d,resetCompleted:h,reset:p,removeCompleted:u,removeFile:g,currentUser:b,translate:L,fileUploadInstance:A,hasAttachedLibItems:D,hasAttachedFileItems:v,isMarkdownHelpTrayOpen:O,libraryModalAttachString:T,libraryModalAttachFallbackString:F,fromWhere:_,attamentsGroupExtraCls:P,isScheduleModalOpen:N,scheduledPostDate:U,handleScheduledPostDateChange:w,handleScheduledPostHourChange:M,handleScheduledPostMinuteChange:x,handleScheduledPostMeridianChange:V,scheduledPostHours:j,scheduledPostMinutes:G,scheduledPostMeridian:B,handleScheduledPostCTAClick:z,handleScheduledPostCancelClick:R,toggleScheduleModal:q,scheduledPostMsg:H,hideScheduledPostMsg:W,scheduledPostMsgVisible:K,currentGroupMembership:Y,handleGifAttachmentPickerClick:X})=>{const J=E.a.isStudent(b),Q=[],Z=K?H:d&&d.scheduleLabel;d&&!d.hideImageAttach&&Q.push(i.a.createElement(m,{key:"img_btn",name:C.a.IMAGE_UPLOAD_BTN,iconType:"image",toolTipStr:L("attach-files-and-images","Attach Files and Images"),attachedFilesChangeCb:t,attachedFilesBeginCb:e,resetCompleted:h,reset:p,removeCompleted:u,removeFile:g,translate:L,fileUploadInstance:A,hasAttached:v})),d&&!d.hideLibraryAttach&&Q.push(i.a.createElement(c.a,{key:"library_btn",toggleLibraryModal:o,isStudent:J,hasAttached:D,fromWhere:_})),d&&d.showGif&&Q.push(i.a.createElement(r.a,{key:"composer_gif_attachment_picker",onSelect:X})),d&&!d.hideFileAttach&&Q.push(i.a.createElement(m,{key:"file_btn",name:C.a.FILE_UPLOAD_BTN,iconType:"clip",toolTipStr:L("postbox-attach-files","Attach Files"),attachedFilesChangeCb:t,attachedFilesBeginCb:e,resetCompleted:h,reset:p,removeCompleted:u,removeFile:g,translate:L,fileUploadInstance:A,hasAttached:v,iconStyle:{position:"relative",bottom:"1px"}})),d&&d.showFormattingHelp&&Q.push(i.a.createElement(f,{key:"format_help_btn",setTrayState:a,isMarkdownHelpTrayOpen:O})),d&&d.showScheduler&&y.a.isOwnerOrCoTeacher(Y)&&Q.push(i.a.createElement(S.a,{key:"scheduler_btn",toggleScheduleModal:q,scheduleLabel:Z,hideScheduledPostMsg:W,scheduledPostMsgVisible:K}));const $=I()("attachments-group",P);return i.a.createElement("div",{className:"attachment-options-container"},i.a.createElement("ul",{className:$},Q?Q.map(e=>e):[]),i.a.createElement(n.a,{toggle:o,isModalOpen:s,attachLibraryItem:l,attachString:T,attachFallbackString:F}),i.a.createElement(k.a,{toggle:q,isModalOpen:N,scheduledPostDate:U,handleScheduledPostDateChange:w,handleScheduledPostHourChange:M,handleScheduledPostMinuteChange:x,handleScheduledPostMeridianChange:V,scheduledPostHours:j,scheduledPostMinutes:G,scheduledPostMeridian:B,handleScheduledPostCTAClick:z,handleScheduledPostCancelClick:R}))}))},1984:function(e,t,a){},2077:function(e,t,a){"use strict";a.r(t);var s=a(15),i=a(4),l=a.n(i),n=a(1199),c=a(133),r=a(134),o=a(364),d=a(1808),h=a(1683),m=a(1275),p=a(226),u=a(1203),g=a.n(u);var b=({url:e,thumbUrl:t,title:a,id:s,messageId:i,handleDismissClick:n})=>{const c=e=>{const t=e&&e.split("/");return t&&t[2]};return t!==p.a.DEFAULT_ICON&&t?l.a.createElement("div",{className:"rounded single-link-item p-0"},l.a.createElement("div",{className:"remove-icon p-2_5 m-2_5 rounded-circle","data-attachment-id":s,"data-attachment-messageid":i,"data-attachment-type":"link",onClick:n,role:"presentation",onKeyPress:n}),l.a.createElement("div",{className:"single-link-image"},l.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer nofollow"},l.a.createElement("div",{className:"rounded-top large-thumb",style:{backgroundImage:"url(".concat(t,")")}}))),l.a.createElement("div",{className:"rounded-bottom single-link-info"},l.a.createElement("a",{className:"link-title mt-3 mx-3 qa-test-single-link-title",href:e,target:"_blank",type:"link",rel:"noopener noreferrer nofollow"},l.a.createElement("h5",null,a)),l.a.createElement("div",{className:"domain body-2-text mx-3 mb-3"},l.a.createElement("a",{href:e,target:"_blank",type:"link",rel:"noopener noreferrer nofollow"},c(e))))):l.a.createElement("div",{className:"rounded single-link-no-image single-link-info p-2_5"},l.a.createElement("div",{className:"link-attachment-icon"},l.a.createElement(m.default,{color:g.a.cyan[30]})),l.a.createElement("div",{className:"single-link-info"},l.a.createElement("a",{className:"link-title ml-3 qa-test-single-link-title",href:e,target:"_blank",type:"link",rel:"noopener noreferrer nofollow"},l.a.createElement("h5",null,a)),l.a.createElement("div",{className:"domain body-2-text mx-3"},l.a.createElement("a",{href:e,target:"_blank",type:"link",rel:"noopener noreferrer nofollow"},c(e)))),l.a.createElement("div",{className:"remove-icon",role:"presentation","data-attachment-id":s,"data-attachment-messageid":i,"data-attachment-type":"link",onClick:n,onKeyPress:n}))},f=a(1696);a(1221);var k=Object(f.a)({})(({s3_name:e,fileName:t,thumbUrl:a,fileProgress:s,messageId:i,id:n,fileType:c,disambiguatedType:r,handleDismissClick:d,isVisible:h})=>{const m=h?"upload-in-progress":"";return l.a.createElement("div",{id:"file-attachment",className:"".concat(m," container file-item qa-test-file-item file-upload rounded px-0")},l.a.createElement("div",{className:"row pl-2_5"},l.a.createElement("div",{className:"file-thumb col-3"},l.a.createElement("span",{className:"icon-background p-2_5 rounded-circle"},l.a.createElement("span",{className:"".concat(c," file-icon")}))),l.a.createElement("div",{className:"file-info col-15"},l.a.createElement("div",{className:"remove-icon",role:"presentation","data-s3-name":e,"data-attachment-id":n,"data-attachment-messageid":i,"data-attachment-type":"file",onClick:d,onKeyPress:d}),l.a.createElement("p",{className:"file-info"},l.a.createElement("span",{className:"title"},t),l.a.createElement("span",{className:"file-type-description secondary-body"},l.a.createElement("em",null,r)," File")))),(e=>{if(s&&h)return l.a.createElement(o.cb,{className:"file-attachment",color:"success",value:e,max:"100"})})(s))});var S=Object(f.a)({})(({s3_name:e,id:t,fileName:a,fileProgress:s,fileType:i,filePreviewUrl:n,messageId:c,handleDismissClick:r,fileSizeFormatted:d,isVisible:h,disambiguatedType:m})=>l.a.createElement("div",{id:"file-attachment",className:"file-item file-upload rounded mr-2 ".concat(m,"-item")},l.a.createElement("div",{className:"file-info",title:a},l.a.createElement("div",{"data-s3-name":e,"data-attachment-id":t,"data-attachment-messageid":c,"data-attachment-type":"file",className:"remove-icon p-2 m_1 rounded-circle",onClick:r}),l.a.createElement("span",{className:"icon-background p-2_5 rounded-circle"},l.a.createElement("span",{className:"".concat(i," file-icon")}))),((e,t)=>{if(e&&t)return l.a.createElement(o.cb,{className:"file-attachment",color:"success",value:e,max:"100"})})(s,h))),L=a(1323);var C=({handleSelectFiles:e,fileInputFieldValue:t,hasAttached:a})=>{const s=["postbox-file"];return a&&s.push("has-active-attachments"),l.a.createElement("li",{className:"qa-test-postbox-file-attach-icon"},l.a.createElement(o.D,{type:"file",id:"postboxFileAttach",color:"link",className:"qa-test-postbox-prompt-attach-image file-attachment-upload-icon",multiple:"multiple",value:t,onChange:e}),l.a.createElement("label",{htmlFor:"postboxFileAttach",className:s.join(" ")},l.a.createElement("div",{id:"image-attachment-prompt",className:"file-item file-upload-prompt rounded mr-2 image-item",role:"button",tabIndex:"0"},l.a.createElement("div",null,l.a.createElement("span",{className:"icon-background p-2_5 rounded-circle"},l.a.createElement("span",{className:"file-icon load-more-icon"}))))))};class A extends i.Component{constructor(e){super(e),this.state={}}render(){const e=this.props,t=e.handleSelectFiles,a=e.fileInputFieldValue,s=e.fileUploadInstance,i=e.hasAttached;return l.a.createElement(C,{handleSelectFiles:t,fileInputFieldValue:a,fileUploadInstance:s,hasAttached:i})}}var I=Object(L.a)({})(A);var E=({handleSelectFiles:e,fileInputFieldValue:t,hasAttached:a})=>{const s=["postbox-file"];return a&&s.push("has-active-attachments"),l.a.createElement("div",{id:"file-attachment-prompt",className:"container file-item file-upload-prompt qa-test-file-item rounded px-0"},l.a.createElement("label",{htmlFor:"postboxFileAttach",className:s.join(" ")},l.a.createElement(o.D,{type:"file",id:"postboxFileAttach",color:"link",className:"qa-test-postbox-prompt-attach-image file-attachment-upload-icon",multiple:"multiple",value:t,onChange:e}),l.a.createElement("div",{className:"upload-prompt-msg-container"},l.a.createElement("span",{className:"file-icon load-more-icon"}),l.a.createElement("span",{className:"pl-2_5 secondary-body"},"Attach another File"))))};class D extends i.Component{constructor(e){super(e),this.state={}}render(){const e=this.props,t=e.handleSelectFiles,a=e.fileInputFieldValue,s=e.fileUploadInstance,i=e.hasAttached;return l.a.createElement(E,{handleSelectFiles:t,fileInputFieldValue:a,fileUploadInstance:s,hasAttached:i})}}var y=Object(L.a)({})(D);var v=Object(f.a)({})(({s3_name:e,id:t,fileName:a,downloadUrl:s,thumbUrl:i,fileProgress:n,fileType:c,messageId:r,handleDismissClick:d,isVisible:h})=>{const m=h?"upload-in-progress":"";return l.a.createElement("div",{className:"".concat(m," container file-item qa-test-file-item file-upload rounded px-0")},l.a.createElement("div",{className:"row pl-2_5"},l.a.createElement("div",{className:"file-thumb col-3"},l.a.createElement("span",{className:"icon-background p-2_5 rounded-circle"},l.a.createElement("span",{className:"".concat(c," file-icon")}))),l.a.createElement("div",{className:"file-info col-15"},l.a.createElement("div",{className:"remove-icon",role:"presentation","data-s3-name":e,"data-attachment-id":t,"data-attachment-messageid":r,"data-attachment-type":"audio",onClick:d,onKeyPress:d}),l.a.createElement("p",{className:"file-info"},l.a.createElement("span",{className:"title"},a),l.a.createElement("span",{className:"file-type-description secondary-body"},"Audio File")))),(e=>{if(n&&h)return l.a.createElement(o.cb,{className:"file-attachment rounded-bottom",color:"success",value:e,max:"100"})})(n))});var O=Object(f.a)({})(({s3_name:e,id:t,fileName:a,downloadUrl:s,thumbUrl:i,fileProgress:n,fileType:c,messageId:r,handleDismissClick:d,isVisible:h})=>{const m=h?"upload-in-progress":"";return l.a.createElement("div",{className:"".concat(m," container file-item qa-test-file-item file-upload rounded px-0")},l.a.createElement("div",{className:"row pl-2_5"},l.a.createElement("div",{className:"file-thumb col-3"},l.a.createElement("span",{className:"icon-background p-2_5 rounded-circle"},l.a.createElement("span",{className:"".concat(c," file-icon")}))),l.a.createElement("div",{className:"file-info col-15"},l.a.createElement("div",{className:"remove-icon",role:"presentation","data-s3-name":e,"data-attachment-id":t,"data-attachment-messageid":r,"data-attachment-type":"video",onClick:d,onKeyPress:d}),l.a.createElement("p",{className:"file-info"},l.a.createElement("span",{className:"title"},a),l.a.createElement("span",{className:"file-type-description secondary-body"},"Video File")))),(e=>{if(n&&h)return l.a.createElement(o.cb,{className:"file-attachment rounded-bottom",color:"success",value:e,max:"100"})})(n))}),T=a(202),F=a(30),_=a(1329),P=a(366),N=a(335);const U=(e,t)=>e?e.map(e=>{const a=e.file_name,s=Object(T.c)(a)||e.type,i=Object(T.b)(s),l=N.a.selectFileThumbnailUrl(t,e.s3_name);return{fileName:a,fileType:s,disambiguatedType:i,s3_name:e.s3_name,id:e.s3_name,fileSize:e.size,fileSizeFormatted:Object(T.a)(e.size),downloadUrl:e.download_url,thumbUrl:Object(T.g)(i,!0,"small"),fileProgress:e.progress,makeCopies:e.makeCopies,copiesStatus:e.copiesStatus,copiesDropdownOpen:e.copiesDropdownOpen,filePreviewUrl:l}}):[];var w=({filesInProgressAttaching:e,attachedLinks:t,attachedEmbeds:a,attachedFiles:s,handleDismissAttachmentClick:i,toggleCopiesDrodown:n,setCopiesStatus:c,translate:r,attachedFilesBeginCb:o,attachedFilesChangeCb:d,uploadedFilesInfo:m})=>{let p=(e=>e?e.map(e=>{const t=e.file_name,a=Object(T.c)(t)||e.file_type||e.type,s=Object(T.b)(a);return{fileName:t,fileType:a,disambiguatedType:s,s3_name:e.s3_name,id:e.s3_name,fileSize:e.size,fileSizeFormatted:Object(T.a)(e.size),downloadUrl:e.download_url,thumbUrl:Object(T.g)(s,!0,"small"),fileProgress:100,makeCopies:e.makeCopies,copiesStatus:e.copiesStatus,copiesDropdownOpen:e.copiesDropdownOpen}}):[])(s);const u=[],g=[],f=[...U(e,m),...p];f.forEach(e=>{const t={key:e.s3_name,showRemove:!0,handleDismissClick:i,toggleCopiesDrodown:n,setCopiesStatus:c},a=Object.assign({},e,t);e.disambiguatedType===F.a.IMAGE?g.push(l.a.createElement(S,a)):e.disambiguatedType===F.a.AUDIO?u.push(l.a.createElement(v,a)):e.disambiguatedType===F.a.VIDEO?u.push(l.a.createElement(O,a)):u.push(l.a.createElement(k,a))}),g.length&&g.push(l.a.createElement(I,{key:"image_attachment_prompt",name:_.a.IMAGE_UPLOAD_PROMPT_BTN,attachedFilesChangeCb:d,attachedFilesBeginCb:o,translate:r}));let L=u.length;return t&&t.forEach(e=>{e.source!==P.a.ONE_DRIVE_SOURCE&&e.source!==P.a.GOOGLE_DRIVE_SOURCE&&(a&&0!==a.length||f&&0!==f.length)||u.push(l.a.createElement(b,{key:e.uid||e.id,id:e.uid||e.id,title:e.title,url:e.url||e.link_url,thumbUrl:e.thumbUrl||e.thumb_url,showRemove:!0,handleDismissClick:i,makeCopies:e.makeCopies,copiesStatus:e.copiesStatus,copiesDropdownOpen:e.copiesDropdownOpen,toggleCopiesDrodown:n,setCopiesStatus:c}))}),a&&a.forEach(e=>{u.push(l.a.createElement(h.a,{key:e.uid,id:e.uid,title:e.title,content:e.content,showRemove:!0,handleDismissClick:i}))}),L&&u.push(l.a.createElement(y,{key:"file_attachment_prompt",name:_.a.FILE_UPLOAD_PROMPT_BTN,attachedFilesChangeCb:d,attachedFilesBeginCb:o,translate:r})),l.a.createElement("div",{className:"attachments-container"},l.a.createElement("div",{className:"images-container mb-2"},g?g.map(e=>e):[]),u?u.map(e=>e):[])},M=a(1932),x=(a(2090),a(2091),a(1233)),V=a(529),j=a(2081),G=a(509),B=a(1798),z=a(73),R=a(1289),q=a(1305),H=a(1288),W=a(1549),K=a(1349),Y=a(103),X=a(12),J=a(341),Q="title",Z="description",$="due_at",ee="task_class_attributes",te="attachments",ae="tag_list",se="class_type",ie="Group",le="id",ne="class_name",ce="CustomClass",re="color",oe="files",de="links",he="embeds",me="class",pe="tags",ue="due_date",ge="hex_color",be=a(22),fe=a(254),ke=a(19),Se=a(449),Le=a(277),Ce=a(0);var Ae=class{static getTitle(e){if(Ce.Map.isMap(e))return e.get(Q)}static getClass(e){if(Ce.Map.isMap(e))return e.get(me)}static getClassType(e){if(Ce.Map.isMap(e))return e.get(se)}static getTags(e){if(Ce.Map.isMap(e))return e.get(pe)}static getDescription(e){if(Ce.Map.isMap(e))return e.get(Z)}static getFileAttachments(e){if(Ce.Map.isMap(e))return e.getIn([te,oe])}static getLinkAttachments(e){if(Ce.Map.isMap(e))return e.getIn([te,de])}static getDueDate(e){if(Ce.Map.isMap(e))return e.get(ue)}},Ie=a(5),Ee=a.n(Ie),De=a(11),ye=a.n(De),ve=a(448),Oe=a(42),Te=a(35),Fe=a.n(Te);const _e=Object(Oe.a)(()=>a.e(317).then(a.bind(null,3034))),Pe=Object(Oe.a)(()=>a.e(334).then(a.bind(null,3035))),Ne=Object(Oe.a)(()=>a.e(333).then(a.bind(null,3036))),Ue=["hh:mm a","hh:mm A","hh:mma"];class we extends l.a.Component{constructor(e){super(e),this.state=we.getInitState(),this.onSelectGroupClass=this.onSelectGroupClass.bind(this),this.onSelectCustomClass=this.onSelectCustomClass.bind(this),this.handleAddClassDropDownToggle=this.handleAddClassDropDownToggle.bind(this),this.handleAddClassDropDownCancelSelecting=this.handleAddClassDropDownCancelSelecting.bind(this),this.handleAddCategoryDropDownToggle=this.handleAddCategoryDropDownToggle.bind(this),this.handleAddCategoryDropDownCancelSelecting=this.handleAddCategoryDropDownCancelSelecting.bind(this),this.handleSelectCategory=this.handleSelectCategory.bind(this),this.handleDueDateDropDownToggle=this.handleDueDateDropDownToggle.bind(this),this.handleAttachedFilesChange=this.handleAttachedFilesChange.bind(this),this.handleAttachedFilesBegin=this.handleAttachedFilesBegin.bind(this),this.handleDismissAttachmentClick=this.handleDismissAttachmentClick.bind(this),this.handleTaskTitleInputValueChange=this.handleTaskTitleInputValueChange.bind(this),this.handleTaskDescriptionInputValueChange=this.handleTaskDescriptionInputValueChange.bind(this),this.onSelectDueDate=this.onSelectDueDate.bind(this),this.onSave=this.onSave.bind(this),this.handleToggle=this.handleToggle.bind(this),this.handleLibraryBtnClick=this.handleLibraryBtnClick.bind(this),this.handleAttachLibraryItem=this.handleAttachLibraryItem.bind(this),this.removeCompleted=this.removeCompleted.bind(this),this.resetCompleted=this.resetCompleted.bind(this),this.onSelectTimeValue=this.onSelectTimeValue.bind(this)}reset(){let e=Object(s.a)({},we.getInitState(),{reset:!0});this.setState(e),this.props.resetLinksState(),this.props.s3FileActions.uploadProgressReset(_.a.FILE_UPLOAD_BTN),this.props.s3FileActions.uploadProgressReset(_.a.IMAGE_UPLOAD_BTN)}static getInitState(){return{selectedGroupClass:null,selectedCustomClass:null,isAddClassDropDownOpen:!1,isAddCategoryDropDownOpen:!1,selectedCategory:"",isDueDateDropDownOpen:!1,filesInProgressAttaching:[],fileUploadInstance:we.fileUploadButtonState(),lastS3FileUploadProgress:null,lastS3ImageUploadProgress:null,lastS3ImageUploadPromptProgress:null,lastS3FileUploadPromptProgress:null,taskTitleInputValue:"",taskDescriptionInputValue:"",selectedDueDate:null,lastIsOpen:!1,isLibraryModalOpen:!1,attachedFiles:[],attachedLibraryItems:[],attachedOneDriveItems:[],attachedGoogleDriveItems:[],lastSelectedLibraryItemsAttachmentList:null,lastSelectedOneDriveItemsAttachmentList:null,lastSelectedGoogleDriveItemsAttachmentList:null,hasAttachedLibItems:!1,selectedTimeValue:"",reset:!1,removeFile:!1}}static getDerivedStateFromProps(e,t){let a={};if(e.s3FileUploadProgress!==t.lastS3FileUploadProgress||e.s3ImageUploadProgress!==t.lastS3ImageUploadProgress||e.s3ImageUploadPromptProgress!==t.lastS3ImageUploadPromptProgress||e.s3FileUploadPromptProgress!==t.lastS3FileUploadPromptProgress){const i=Ee.a.cloneDeep(t.filesInProgressAttaching);let l=!1;l=l||we.updateFilesInProgressAttachingForProgressEvent(e.s3FileUploadProgress,i),l=l||we.updateFilesInProgressAttachingForProgressEvent(e.s3ImageUploadProgress,i),l=l||we.updateFilesInProgressAttachingForProgressEvent(e.s3ImageUploadPromptProgress,i),l=l||we.updateFilesInProgressAttachingForProgressEvent(e.s3FileUploadPromptProgress,i),l&&(a=Object(s.a)({},a,{filesInProgressAttaching:i,lastS3FileUploadProgress:e.s3FileUploadProgress,lastS3ImageUploadProgress:e.s3ImageUploadProgress,lastS3ImageUploadPromptProgress:e.s3ImageUploadPromptProgress,lastS3FileUploadPromptProgress:e.s3FileUploadPromptProgress}))}if(e.isOpen&&!t.lastIsOpen){const t=e.todoModel;if(t&&Le.a.getTodoType(t)===be.a.TASK&&Le.a.getItem(t)){let i,l,n=Le.a.getItem(t),c=null,r=null,o="",d=null,h="",m=[];i=Ae.getTitle(n)||"";let p=Ae.getClass(n),u=Ae.getClassType(n);p&&Ce.Map.isMap(p)&&(u===ie?c=Object(Ce.Map)({[X.a.GROUP_TITLE]:p.get(ne),[X.a.COLOR]:p.get(re),[X.a.GROUP_HEX_COLOR]:p.get(ge),[X.a.GROUP_ID]:p.get(le)}):u===ce&&(r=Object(Ce.Map)({[J.a.CLASS_NAME]:p.get(ne),[J.a.COLOR]:p.get(re),[J.a.HEX_COLOR]:p.get(ge),[J.a.ID]:p.get(le)})));let g=Ae.getTags(n)||Object(Ce.List)();g.size&&(o=g.get(0)||""),l=Ae.getDescription(n)||"";let b=Ae.getDueDate(n);b&&(d=new Date(b),h=ye()(d).format("hh:mm a"));let f=Ae.getFileAttachments(n);f&&f.size&&(m=f.toJS());let k=Ae.getLinkAttachments(n);k&&k.size&&e.addLibraryLinks(k.toJS()),a=Object(s.a)({},a,{taskTitleInputValue:i,selectedGroupClass:c,selectedCustomClass:r,selectedCategory:o,taskDescriptionInputValue:l,selectedDueDate:d,selectedTimeValue:h,attachedFiles:m})}else{if(e.leftSelectionInfo&&e.leftSelectionInfo.get(Y.a.TYPE)===Y.a.GROUP_TYPE){let t=e.groupList.get(e.leftSelectionInfo.get(Y.a.GROUP_MEMBERSHIP_ID).toString());a=Object(s.a)({},a,{selectedGroupClass:t,selectedCustomClass:null})}else if(e.leftSelectionInfo&&e.leftSelectionInfo.get(Y.a.TYPE)===Y.a.CUSTOM_CLASS_TYPE){let t=e.classList.get(e.leftSelectionInfo.get(Y.a.CUSTOM_CLASS_ID).toString());a=Object(s.a)({},a,{selectedGroupClass:null,selectedCustomClass:t})}else if(e.defaultSelectedGroupId){let t=e.groupList.valueSeq().find(t=>ke.a.getGroupId(t)===e.defaultSelectedGroupId)||null;a=Object(s.a)({},a,{selectedGroupClass:t,selectedCustomClass:null})}else a=e.defaultSelectedGroupClass?Object(s.a)({},a,{selectedGroupClass:e.defaultSelectedGroupClass,selectedCustomClass:null}):Object(s.a)({},a,{selectedGroupClass:null,selectedCustomClass:null});e.defaultLinks&&e.addLibraryLinks(e.defaultLinks),a=Object(s.a)({},a,{selectedDueDate:e.defaultDueDate,selectedTimeValue:"",taskDescriptionInputValue:e.defaultDescription||""})}}if(t.lastIsOpen!==e.isOpen&&(a=Object(s.a)({},a,{lastIsOpen:e.isOpen})),e.selectedLibraryItemsAttachmentList&&e.selectedLibraryItemsAttachmentList.length&&e.selectedLibraryItemsAttachmentList!==t.lastSelectedLibraryItemsAttachmentList){let t=we.getAttachedLibraryItems(e.selectedLibraryItemsAttachmentList);a=Object(s.a)({},a,{attachedLibraryItems:t,lastSelectedLibraryItemsAttachmentList:e.selectedLibraryItemsAttachmentList})}if(e.selectedOneDriveItemsAttachmentList&&e.selectedOneDriveItemsAttachmentList.length&&e.selectedOneDriveItemsAttachmentList!==t.lastSelectedOneDriveItemsAttachmentList){let t=we.getAttachedOneDriveItems(e.selectedOneDriveItemsAttachmentList,e);a=Object(s.a)({},a,{attachedOneDriveItems:t,lastSelectedOneDriveItemsAttachmentList:e.selectedOneDriveItemsAttachmentList})}if(e.selectedGoogleDriveItemsAttachmentList&&e.selectedGoogleDriveItemsAttachmentList.length&&e.selectedGoogleDriveItemsAttachmentList!==t.lastSelectedGoogleDriveItemsAttachmentList){let t=we.getAttachedGoogleDriveItems(e.selectedGoogleDriveItemsAttachmentList);a=Object(s.a)({},a,{attachedGoogleDriveItems:t,lastSelectedGoogleDriveItemsAttachmentList:e.selectedGoogleDriveItemsAttachmentList})}return Object.keys(a).length>0?a:null}static updateFilesInProgressAttachingForProgressEvent(e,t){if(e){const a=fe.a.getFileUploadProgress(e),s=t.findIndex(t=>t.id===e.file.id);if(s>-1&&t[s].progress!==a)return t[s].progress=a,!0}return!1}static fileUploadButtonState(){let e=null;return{save:t=>{e=t},get:()=>e}}static getAttachedLibraryItems(e){const t=[];return e&&e.forEach(e=>{if(e){let a=Ee.a.cloneDeep([...e.get("item")]).reduce((function(e,t){return e[t[0]]=t[1],e}),{libraryItemId:e.get("id"),type:e.get("type"),source:"edmodo"});t.push(a)}}),t}static getAttachedOneDriveItems(e,t){const a=[];return e&&e.forEach(e=>{if(e){const s=e.get("id"),i=e.get("sharingLink");i||t.oneDriveApisActions&&t.oneDriveApisActions.createSharingLink(t.currentUserOfficeAccessToken,s),a.push({type:"link",uid:s,title:e.get("name"),link_url:i||e.get("@microsoft.graph.downloadUrl"),url:i||e.get("@microsoft.graph.downloadUrl"),source:"one_drive"})}}),a}static getAttachedGoogleDriveItems(e){const t=[];return e&&e.forEach(e=>{e&&t.push({type:"link",uid:e.get("id"),title:e.get("name"),link_url:e.get("webViewLink"),url:e.get("webViewLink"),source:"google_drive"})}),t}onSelectGroupClass(e){this.setState({selectedGroupClass:e,selectedCustomClass:null})}onSelectCustomClass(e){this.setState({selectedGroupClass:null,selectedCustomClass:e})}handleAddClassDropDownToggle(){this.setState(e=>({isAddClassDropDownOpen:!e.isAddClassDropDownOpen}))}handleAddClassDropDownCancelSelecting(){this.setState({selectedGroupClass:null,selectedCustomClass:null})}handleAddCategoryDropDownToggle(){this.setState(e=>({isAddCategoryDropDownOpen:!e.isAddCategoryDropDownOpen}))}handleAddCategoryDropDownCancelSelecting(){this.setState({selectedCategory:""})}handleSelectCategory(e){this.setState({selectedCategory:e})}handleDueDateDropDownToggle(){this.state.selectedTimeValue&&!ye()(this.state.selectedTimeValue,Ue).isValid()&&this.setState({selectedTimeValue:""}),this.setState(e=>({isDueDateDropDownOpen:!e.isDueDateDropDownOpen}))}handleAttachedFilesChange(e){if(!Array.isArray(e)||0===e.length)return;const t=this.state.filesInProgressAttaching.map(t=>{const a=e.find(e=>e.id===t.id);return void 0===a?t:Object.assign({},t,a)});this.setState({filesInProgressAttaching:t})}handleAttachedFilesBegin(e){if(!Array.isArray(e)||0===e.length)return;this.props.resetLinksState();let t=Ee.a.cloneDeep(this.state.filesInProgressAttaching),a=[];e.forEach(e=>{-1===t.findIndex(t=>t.s3_name===e.s3_name)&&(e.progress=0,a.push(e))}),t=t.concat(a),this.setState({filesInProgressAttaching:t})}removeLibraryItemsFromAttachmentList(e){const t=(e,t)=>{const a=Ee.a.cloneDeep(t),s=a.map(e=>e.id).indexOf(e);return a.splice(s,1),t};e.forEach(e=>{let a;switch(e&&e.source){case"edmodo":a=t(e.libraryItemId,this.state.attachedLibraryItems),this.setState({attachedLibraryItems:a}),this.props.libraryActions.updateSelectedLibraryItemStatusSuccessAction("ComposerLibraryModal",e.libraryItemId,0,"edmodo");break;case"one_drive":a=t(e.uid,this.state.attachedOneDriveItems),this.setState({attachedOneDriveItems:a}),this.props.libraryActions.updateSelectedLibraryItemStatusSuccessAction("ComposerLibraryModal",e.uid,0,"one_drive");break;case"google_drive":a=t(e.uid,this.state.attachedGoogleDriveItems),this.setState({attachedGoogleDriveItems:a}),this.props.libraryActions.updateSelectedLibraryItemStatusSuccessAction("ComposerLibraryModal",e.uid,0,"google_drive")}})}handleDismissAttachmentClick(e){const t=e.target.getAttribute("data-attachment-type"),a=parseInt(e.target.getAttribute("data-attachment-id"),10);if(["embed","link"].includes(t)){const e=this.props.dismissAttachmentById(a);this.removeLibraryItemsFromAttachmentList(e)}else{const t=e.target.getAttribute("data-s3-name"),s=Ee.a.cloneDeep(this.state.attachedFiles),i=Ee.a.cloneDeep(this.state.filesInProgressAttaching);let l=s.findIndex(e=>e.s3_name===t);-1!==l&&s.splice(l,1),l=i.findIndex(e=>e.s3_name===t),-1!==l&&i.splice(l,1),this.setState({filesInProgressAttaching:i,attachedFiles:s,removeFile:a},()=>{this.setHasLibraryAttachments(this.state.attachedFiles)})}}isUploadInProgress(){return-1!==this.state.filesInProgressAttaching.findIndex(e=>e&&e.progress<100)}handleTaskTitleInputValueChange(e){let t=e.target.value;this.getCharactorSize(t)>250&&(t=t.substr(0,250)),this.setState({taskTitleInputValue:t})}handleTaskDescriptionInputValueChange(e){let t=e.target.value;this.getCharactorSize(t)>250&&(t=t.substr(0,250)),this.setState({taskDescriptionInputValue:t})}getCharactorSize(e){return e.length}caculateDueDate(e,t){if(e&&t){let a=ye()(t,Ue);a.isValid()&&(e.setHours(a.hours()),e.setMinutes(a.minutes()),e.setSeconds(a.seconds()),e.setMilliseconds(a.milliseconds()))}return e}onSelectDueDate(e){e=this.caculateDueDate(e,this.state.selectedTimeValue),this.setState({selectedDueDate:e})}onSelectTimeValue(e){let t=this.caculateDueDate(this.state.selectedDueDate,e);this.setState({selectedTimeValue:e,selectedDueDate:t})}onSave(){let e={};e[Q]=this.state.taskTitleInputValue,this.state.taskDescriptionInputValue?e[Z]=this.state.taskDescriptionInputValue:e[Z]="",this.state.selectedDueDate?e[$]=this.state.selectedDueDate.toISOString():e[$]=null,this.state.selectedGroupClass?e[ee]={[se]:ie,[le]:ke.a.getGroupIdFromCompactGroupMembership(this.state.selectedGroupClass),[ne]:ke.a.getGroupTitleFromCompactGroupMembership(this.state.selectedGroupClass)}:this.state.selectedCustomClass?e[ee]={[se]:ce,[le]:Se.a.getClassId(this.state.selectedCustomClass),[ne]:Se.a.getClassName(this.state.selectedCustomClass),[re]:Se.a.getClassColorKey(this.state.selectedCustomClass)}:e[ee]={};let t={},a=Ee.a.cloneDeep(this.state.attachedFiles);const s=Ee.a.cloneDeep(this.state.filesInProgressAttaching);let i=[];if(a&&(i=[...i,...a]),s&&(i=[...i,...s]),i=i.map(e=>e.attachment_id?{attachment_id:e.attachment_id}:{file_name:e.file_name,s3_name:e.s3_name,size:e.size,file_type:e.file_type}),t[oe]=i,this.props.attachedLinks.length){let e=Ee.a.cloneDeep(this.props.attachedLinks);e=e.map(e=>e.attachment_id?{attachment_id:e.attachment_id}:{title:e.title,url:e.link_url||e.url,thumb_url:e.thumb_url||e.thumbUrl,link_url:e.link_url||e.url}),t[de]=e}else t[de]=[];if(this.props.attachedEmbeds.length){const e=Ee.a.cloneDeep(this.props.attachedEmbeds),a=[];e.forEach(e=>{const t=e.content,s=e.title;a.push({content:t,title:s})}),t[he]=a}else t[he]=[];e[te]=t,this.state.selectedCategory&&this.state.selectedCategory!==be.a.TASK?e[ae]=this.state.selectedCategory:e[ae]="",this.props.todoModel?this.props.studentPlannerActions.updateTask(Le.a.getTodoItemId(this.props.todoModel),this.props.todoModel,e):this.props.studentPlannerActions.createTask(e),this.reset(),this.props.onToggle&&this.props.onToggle()}handleToggle(){this.props.isOpen&&this.reset(),this.props.onToggle&&this.props.onToggle()}handleLibraryBtnClick(){this.setState(e=>({isLibraryModalOpen:!e.isLibraryModalOpen}))}setHasLibraryAttachments(e=[]){const t=!!e.filter(e=>e.libraryItemId).length;this.setState({hasAttachedLibItems:t})}sortLibItemsIntoAttachmentBuckets(){const e=this.state.attachedLibraryItems.concat(this.state.attachedOneDriveItems).concat(this.state.attachedGoogleDriveItems),t=Ee.a.cloneDeep(this.state.attachedFiles),a=[];e.forEach(e=>{switch(e.type){case"file":t.find(t=>t.file_name===e.file_name)||(a.push(e),this.setHasLibraryAttachments(a));break;case"link":this.props.addLibraryLink(e)}}),this.setState({attachedFiles:t.concat(a)})}handleAttachLibraryItem(){this.sortLibItemsIntoAttachmentBuckets(),this.setState(e=>({isLibraryModalOpen:!e.isLibraryModalOpen}))}removeCompleted(){this.setState({removeFile:!1})}resetCompleted(){this.setState({reset:!1})}componentDidUpdate(e,t,a){!e.isOpen&&this.props.isOpen&&this.titleTextArea&&this.titleTextArea.focus()}render(){const e=this.props,t=e.isOpen,a=e.title,s=e.translate,i=e.isNesting,n=l.a.createElement(l.a.Fragment,null,l.a.createElement(o.P,{toggle:this.handleToggle},l.a.createElement("div",{className:"task-modal-title"},a)),l.a.createElement(o.N,null,l.a.createElement(d.a,{inputRef:e=>{this.titleTextArea=e},className:"task-title-input-textarea",minRows:1,placeholder:s("student_planner_task_edit_modal_title_placeholder","Task title"),value:this.state.taskTitleInputValue,onChange:this.handleTaskTitleInputValueChange}),l.a.createElement("div",{className:"add-options-container"},l.a.createElement(Pe,Object.assign({},this.props,{selectedGroupClass:this.state.selectedGroupClass,selectedCustomClass:this.state.selectedCustomClass,onSelectGroupClass:this.onSelectGroupClass,onSelectCustomClass:this.onSelectCustomClass,onCancelSelecting:this.handleAddClassDropDownCancelSelecting,isOpen:this.state.isAddClassDropDownOpen,toggle:this.handleAddClassDropDownToggle})),l.a.createElement(Ne,Object.assign({},this.props,{selectedCategory:this.state.selectedCategory,onSelectCategory:this.handleSelectCategory,onCancelSelecting:this.handleAddCategoryDropDownCancelSelecting,isOpen:this.state.isAddCategoryDropDownOpen,toggle:this.handleAddCategoryDropDownToggle}))),l.a.createElement("div",{className:"modal-separating-line"}),l.a.createElement("div",{className:"modal-list-group-wrapper"},l.a.createElement(o.I,{className:"modal-list-group"},l.a.createElement("section",{className:"post-composer-body expanded",role:"form","aria-labelledby":"note"},l.a.createElement(d.a,{className:"task-description-input-textarea",minRows:1,placeholder:s("student_planner_task_edit_modal_description_placeholder","Description"),value:this.state.taskDescriptionInputValue,onChange:this.handleTaskDescriptionInputValueChange}),l.a.createElement(w,{filesInProgressAttaching:this.state.filesInProgressAttaching,attachedFilesChangeCb:this.handleAttachedFilesChange,attachedFilesBeginCb:this.handleAttachedFilesBegin,attachedFiles:this.state.attachedFiles,attachedLinks:this.props.attachedLinks,attachedEmbeds:this.props.attachedEmbeds,handleDismissAttachmentClick:this.handleDismissAttachmentClick,translate:s,uploadedFilesInfo:this.props.uploadedS3FilesInfo}))))),l.a.createElement(o.O,null,l.a.createElement("div",{className:"footer-container"},l.a.createElement("div",{className:"footer-left-content"},l.a.createElement(M.a,{attachedFilesChangeCb:this.handleAttachedFilesChange,attachedFilesBeginCb:this.handleAttachedFilesBegin,fileUploadInstance:this.state.fileUploadInstance,attachmentDisplayOptions:{},translate:s,isStudent:this.props.currentUserIsStudent,handleLibraryBtnClick:this.handleLibraryBtnClick,attachLibraryItem:this.handleAttachLibraryItem,isLibraryModalOpen:this.state.isLibraryModalOpen,resetCompleted:this.resetCompleted,reset:this.state.reset,removeCompleted:this.removeCompleted,removeFile:this.state.removeFile,selectedLink:this.props.selectedLink,isEmbed:!!this.props.selectedEmbedSrc,libraryModalAttachString:"student_planner_task_attach_file",libraryModalAttachFallbackString:"Attach to task",fromWhere:"fromStudentPlanner",attamentsGroupExtraCls:"footer-left-attachments-group"})),l.a.createElement("div",{className:"footer-right-content"},l.a.createElement(_e,Object.assign({},this.props,{isOpen:this.state.isDueDateDropDownOpen,toggle:this.handleDueDateDropDownToggle,selectedDueDate:this.state.selectedDueDate,onSelectDueDate:this.onSelectDueDate,selectedTimeValue:this.state.selectedTimeValue,onSelectTimeValue:this.onSelectTimeValue})),l.a.createElement(o.c,{className:Fe()("qa-test-save-button"),color:"primary",disabled:!this.state.taskTitleInputValue||this.isUploadInProgress(),onClick:this.onSave},s("student_planner_save","Save"))))));return i?l.a.createElement("div",{className:"student-planner-task-edit-modal",id:"taskEditModal"},n):l.a.createElement(o.M,{isOpen:t,toggle:this.handleToggle,centered:!0,className:"student-planner-task-edit-modal",id:"taskEditModal"},n)}}we.defaultProps={leftSelectionInfo:Object(Ce.Map)({[Y.a.TYPE]:Y.a.ALL_TASKS_TYPE,[Y.a.UNIQUE_KEY]:ve.a()}),isNesting:!1};t.default=Object(G.a)(Object(n.a)(Object(c.connect)((function(e){return{currentUserIsStudent:z.l(e),s3FileUploadProgress:R.f(e,{name:_.a.FILE_UPLOAD_BTN}),s3ImageUploadProgress:R.f(e,{name:_.a.IMAGE_UPLOAD_BTN}),s3ImageUploadPromptProgress:R.f(e,{name:_.a.IMAGE_UPLOAD_PROMPT_BTN}),s3FileUploadPromptProgress:R.f(e,{name:_.a.FILE_UPLOAD_PROMPT_BTN}),uploadedS3FilesInfo:R.g(e),selectedLibraryItemsAttachmentList:H.b(e,{name:"ComposerLibraryModal"}),selectedOneDriveItemsAttachmentList:W.a(e,{name:"ComposerLibraryModal"}),selectedGoogleDriveItemsAttachmentList:K.a(e,{name:"ComposerLibraryModal"})}}),(function(e){return{studentPlannerActions:Object(r.bindActionCreators)(j,e),libraryActions:Object(r.bindActionCreators)(x,e),s3FileActions:Object(r.bindActionCreators)(V,e),oneDriveApisActions:Object(r.bindActionCreators)(q,e)}}))(Object(B.a)({max:1})(we))))},2090:function(e,t,a){},2091:function(e,t,a){}}]);
//# sourceMappingURL=31.c14c09b0.chunk.js.map